/* ==========================================================================
   Adaptive Cards - M365 Theme Stylesheet

<hr class='pagebreak'/>
   This stylesheet overrides the default Adaptive Cards styling to match
   the Microsoft 365 design language used throughout the application.
   ========================================================================== */

/* ==========================================================================
   Card Container
   ========================================================================== */

.adaptive-card-container {
    max-width: 100%;
    margin: 0.5rem 0;
}

/* Main Adaptive Card wrapper - multiple selectors for compatibility */
.ac-adaptiveCard,
.ac-m365-theme,
div[class*="ac-adaptiveCard"] {
    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif !important;
    background: #ffffff !important;
    border: 1px solid #e5e5e5 !important;
    border-radius: 8px !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08) !important;
    padding: 1.25rem !important;
    overflow: hidden;
    transition: box-shadow 0.2s ease, border-color 0.2s ease;
}

    .ac-adaptiveCard:hover,
    .ac-m365-theme:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1) !important;
    }

/* ==========================================================================
   Fix Required Field Labels (Red → M365 Style)
   ========================================================================== */

/* Override red required labels to use M365 styling */
.ac-textBlock[style*="color: rgb(255"],
.ac-textBlock[style*="color: #ff"],
.ac-textBlock[style*="color: #FF"],
.ac-textBlock[style*="color: rgb(209, 52, 56)"],
.ac-textBlock[style*="attention"],
div[class*="ac-"] p[style*="color: rgb(255"],
div[class*="ac-"] p[style*="color: #ff"] {
    color: #242424 !important;
    font-weight: 600 !important;
}

    /* Style the asterisk for required fields */
    .ac-textBlock[style*="color: rgb(255"]::after,
    .ac-textBlock[style*="attention"]::after {
        color: #d13438 !important;
    }

/* ==========================================================================
   Typography - Fix red labels and improve text styling
   ========================================================================== */

/* Text blocks */
.ac-textBlock,
div[class*="ac-"] p,
div[class*="ac-"] span {
    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif !important;
    line-height: 1.5 !important;
}

    /* Fix ALL red/attention colored text to be proper label color */
    /* These selectors target the inline styles Adaptive Cards applies */
    .ac-textBlock[style*="color: rgb(255, 0, 0)"],
    .ac-textBlock[style*="color: rgb(209, 52, 56)"],
    .ac-textBlock[style*="color: rgb(196, 49, 75)"],
    .ac-textBlock[style*="color:#ff"],
    .ac-textBlock[style*="color: #ff"],
    .ac-textBlock[style*="color:#FF"],
    .ac-textBlock[style*="color: #FF"],
    .ac-textBlock[style*="color: #d13438"],
    .ac-textBlock[style*="color: #D13438"],
    .ac-textBlock[style*="color:rgb(255"],
    .ac-textBlock[style*="color: rgb(255"],
    p[style*="color: rgb(255"],
    p[style*="color: rgb(209, 52, 56)"],
    span[style*="color: rgb(255"],
    span[style*="color: rgb(209, 52, 56)"] {
        color: #242424 !important;
        font-weight: 600 !important;
        font-size: 0.875rem !important;
    }

/* Default text color */
.ac-textBlock {
    color: #242424 !important;
}

    /* Headings */
    .ac-textBlock[style*="font-size: 22px"],
    .ac-textBlock[style*="font-size: 24px"],
    .ac-textBlock[style*="font-size: 26px"] {
        font-weight: 600 !important;
        color: #242424 !important;
        margin-bottom: 0.375rem !important;
    }

    /* Large text - card titles */
    .ac-textBlock[style*="font-size: 18px"],
    .ac-textBlock[style*="font-size: 20px"] {
        font-weight: 600 !important;
        color: #242424 !important;
    }

    /* Subtle/secondary text */
    .ac-textBlock[style*="color: rgb(97, 97, 97)"],
    .ac-textBlock[style*="color: #616161"],
    .ac-textBlock.subtle {
        color: #616161 !important;
    }

/* ==========================================================================
   Buttons / Actions - Enhanced selectors
   ========================================================================== */

/* Action set container */
.ac-actionSet {
    margin-top: 1rem !important;
    padding-top: 1rem !important;
    display: flex !important;
    gap: 0.5rem !important;
    justify-content: flex-end !important;
}

    /* Base button styling - comprehensive selectors */
    .ac-pushButton,
    button.ac-pushButton,
    div[class*="ac-"] button,
    .ac-actionSet button,
    .ac-action-submit,
    .ac-action-openUrl,
    .ac-action-showCard,
    .ac-action-execute {
        font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif !important;
        font-size: 0.875rem !important;
        font-weight: 600 !important;
        padding: 0.5rem 1.25rem !important;
        border-radius: 6px !important;
        cursor: pointer !important;
        transition: all 0.15s ease !important;
        min-width: 80px !important;
        text-align: center !important;
        position: relative;
        overflow: hidden;
        /* Default to primary style */
        background: #5b5fc7 !important;
        color: #ffffff !important;
        border: 1px solid #5b5fc7 !important;
    }

        /* Button hover state */
        .ac-pushButton:hover,
        button.ac-pushButton:hover,
        div[class*="ac-"] button:hover,
        .ac-actionSet button:hover {
            background: #4a4eb5 !important;
            border-color: #4a4eb5 !important;
            box-shadow: 0 2px 6px rgba(91, 95, 199, 0.3) !important;
        }

        /* Button active state */
        .ac-pushButton:active,
        button.ac-pushButton:active,
        div[class*="ac-"] button:active,
        .ac-actionSet button:active {
            background: #3d4099 !important;
            border-color: #3d4099 !important;
            transform: translateY(1px);
        }

        /* Button focus state */
        .ac-pushButton:focus,
        button.ac-pushButton:focus,
        div[class*="ac-"] button:focus,
        .ac-actionSet button:focus {
            outline: none !important;
            box-shadow: 0 0 0 2px rgba(91, 95, 199, 0.4) !important;
        }

        /* Primary button style (first/main action) */
        .ac-pushButton.style-positive,
        .ac-actionSet > .ac-pushButton:first-child,
        .ac-pushButton[style*="background-color: rgb(91, 95, 199)"] {
            background: #5b5fc7 !important;
            color: #ffffff !important;
            border: 1px solid #5b5fc7 !important;
        }

            .ac-pushButton.style-positive:hover,
            .ac-actionSet > .ac-pushButton:first-child:hover,
            .ac-pushButton[style*="background-color: rgb(91, 95, 199)"]:hover {
                background: #4a4eb5 !important;
                border-color: #4a4eb5 !important;
                box-shadow: 0 2px 6px rgba(91, 95, 199, 0.3) !important;
            }

            .ac-pushButton.style-positive:active,
            .ac-actionSet > .ac-pushButton:first-child:active,
            .ac-pushButton[style*="background-color: rgb(91, 95, 199)"]:active {
                background: #3d4099 !important;
                border-color: #3d4099 !important;
                transform: translateY(1px);
            }

        /* Secondary/Default button style - when there are multiple buttons */
        .ac-pushButton.style-default,
        .ac-actionSet > .ac-pushButton:not(:first-child) {
            background: #ffffff !important;
            color: #242424 !important;
            border: 1px solid #d1d5db !important;
        }

            .ac-pushButton.style-default:hover,
            .ac-actionSet > .ac-pushButton:not(:first-child):hover {
                background: #f5f5f5 !important;
                border-color: #a3a3a3 !important;
                box-shadow: none !important;
            }

            .ac-pushButton.style-default:active,
            .ac-actionSet > .ac-pushButton:not(:first-child):active {
                background: #e5e5e5 !important;
                transform: translateY(1px);
            }

        /* Destructive button style */
        .ac-pushButton.style-destructive {
            background: #ffffff !important;
            color: #d13438 !important;
            border: 1px solid #d13438 !important;
        }

            .ac-pushButton.style-destructive:hover {
                background: #fef1f1 !important;
                border-color: #a82a2d !important;
            }

            .ac-pushButton.style-destructive:active {
                background: #fde4e4 !important;
                transform: translateY(1px);
            }

/* Button ripple effect */
.ac-button-ripple {
    position: absolute;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    transform: scale(0);
    animation: ac-ripple 0.6s ease-out;
    pointer-events: none;
    width: 100px;
    height: 100px;
    margin-left: -50px;
    margin-top: -50px;
}

@keyframes ac-ripple {
    to {
        transform: scale(4);
        opacity: 0;
    }
}

/* ==========================================================================
   Inputs - Enhanced selectors for Adaptive Cards
   ========================================================================== */

/* Input container */
.ac-input-container {
    margin-bottom: 0.75rem !important;
}

/* Text inputs - comprehensive selectors */
.ac-input,
.ac-textInput,
.ac-input input,
.ac-input textarea,
.ac-textInput input,
.ac-textInput textarea,
input.ac-input,
textarea.ac-input,
div[class*="ac-"] input[type="text"],
div[class*="ac-"] input[type="email"],
div[class*="ac-"] input[type="tel"],
div[class*="ac-"] input[type="url"],
div[class*="ac-"] input[type="password"],
div[class*="ac-"] input[type="number"],
div[class*="ac-"] textarea {
    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif !important;
    font-size: 0.9375rem !important;
    padding: 0.625rem 0.875rem !important;
    border: 1px solid #d1d5db !important;
    border-radius: 6px !important;
    background: #ffffff !important;
    color: #242424 !important;
    transition: border-color 0.2s ease, box-shadow 0.2s ease !important;
    width: 100% !important;
    box-sizing: border-box !important;
    outline: none !important;
}

    .ac-input:focus,
    .ac-textInput:focus,
    .ac-input input:focus,
    .ac-input textarea:focus,
    .ac-textInput input:focus,
    .ac-textInput textarea:focus,
    input.ac-input:focus,
    textarea.ac-input:focus,
    div[class*="ac-"] input:focus,
    div[class*="ac-"] textarea:focus,
    .ac-input-focused .ac-input,
    .ac-input-focused input {
        outline: none !important;
        border-color: #5b5fc7 !important;
        box-shadow: 0 0 0 2px rgba(91, 95, 199, 0.25) !important;
    }

    .ac-input::placeholder,
    .ac-textInput::placeholder,
    div[class*="ac-"] input::placeholder,
    div[class*="ac-"] textarea::placeholder {
        color: #a3a3a3 !important;
    }

/* Input labels */
.ac-input-label,
div[class*="ac-"] label {
    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif !important;
    font-size: 0.875rem !important;
    font-weight: 600 !important;
    color: #242424 !important;
    margin-bottom: 0.375rem !important;
    display: block !important;
}

/* Required field indicator */
.ac-input-label-required::after {
    content: " *";
    color: #d13438 !important;
}

/* Error messages */
.ac-input-validation-failed,
.ac-input-error {
    border-color: #d13438 !important;
}

.ac-input-error-message {
    color: #d13438 !important;
    font-size: 0.8125rem !important;
    margin-top: 0.25rem !important;
}

/* ==========================================================================
   Choice Sets (Radio buttons & Checkboxes)
   ========================================================================== */

.ac-choiceSetInput-expanded {
    display: flex !important;
    flex-direction: column !important;
    gap: 0.5rem !important;
}

    .ac-choiceSetInput-expanded .ac-input {
        display: flex !important;
        align-items: center !important;
        gap: 0.5rem !important;
        padding: 0 !important;
        border: none !important;
        background: transparent !important;
    }

    /* Radio buttons */
    .ac-choiceSetInput-expanded input[type="radio"] {
        appearance: none !important;
        width: 18px !important;
        height: 18px !important;
        border: 2px solid #616161 !important;
        border-radius: 50% !important;
        cursor: pointer !important;
        transition: all 0.15s ease !important;
        position: relative !important;
        flex-shrink: 0 !important;
    }

        .ac-choiceSetInput-expanded input[type="radio"]:checked {
            border-color: #5b5fc7 !important;
        }

            .ac-choiceSetInput-expanded input[type="radio"]:checked::after {
                content: '' !important;
                position: absolute !important;
                width: 10px !important;
                height: 10px !important;
                background: #5b5fc7 !important;
                border-radius: 50% !important;
                top: 50% !important;
                left: 50% !important;
                transform: translate(-50%, -50%) !important;
            }

        .ac-choiceSetInput-expanded input[type="radio"]:focus {
            outline: none !important;
            box-shadow: 0 0 0 2px rgba(91, 95, 199, 0.4) !important;
        }

    /* Checkboxes */
    .ac-choiceSetInput-expanded input[type="checkbox"] {
        appearance: none !important;
        width: 18px !important;
        height: 18px !important;
        border: 2px solid #616161 !important;
        border-radius: 4px !important;
        cursor: pointer !important;
        transition: all 0.15s ease !important;
        position: relative !important;
        flex-shrink: 0 !important;
    }

        .ac-choiceSetInput-expanded input[type="checkbox"]:checked {
            background: #5b5fc7 !important;
            border-color: #5b5fc7 !important;
        }

            .ac-choiceSetInput-expanded input[type="checkbox"]:checked::after {
                content: '' !important;
                position: absolute !important;
                width: 5px !important;
                height: 9px !important;
                border: 2px solid white !important;
                border-top: none !important;
                border-left: none !important;
                top: 1px !important;
                left: 5px !important;
                transform: rotate(45deg) !important;
            }

        .ac-choiceSetInput-expanded input[type="checkbox"]:focus {
            outline: none !important;
            box-shadow: 0 0 0 2px rgba(91, 95, 199, 0.4) !important;
        }

/* Dropdown/Select inputs */
.ac-choiceSetInput-compact select,
select.ac-input {
    appearance: none !important;
    background: #ffffff url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23616161' d='M6 8L1 3h10z'/%3E%3C/svg%3E") no-repeat right 0.75rem center !important;
    padding-right: 2.5rem !important;
    cursor: pointer !important;
}

/* ==========================================================================
   Date/Time Inputs
   ========================================================================== */

.ac-dateInput input,
.ac-timeInput input {
    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif !important;
    font-size: 0.9375rem !important;
    padding: 0.625rem 0.875rem !important;
    border: 1px solid #d1d5db !important;
    border-radius: 6px !important;
    background: #ffffff !important;
    color: #242424 !important;
}

    .ac-dateInput input:focus,
    .ac-timeInput input:focus {
        outline: none !important;
        border-color: #5b5fc7 !important;
        box-shadow: 0 0 0 1px #5b5fc7 !important;
    }

/* ==========================================================================
   Toggle Inputs
   ========================================================================== */

.ac-toggleInput {
    display: flex !important;
    align-items: center !important;
    gap: 0.75rem !important;
}

    .ac-toggleInput input[type="checkbox"] {
        appearance: none !important;
        width: 44px !important;
        height: 24px !important;
        background: #c4c4c4 !important;
        border-radius: 12px !important;
        position: relative !important;
        cursor: pointer !important;
        transition: all 0.2s ease !important;
        flex-shrink: 0 !important;
    }

        .ac-toggleInput input[type="checkbox"]::after {
            content: '' !important;
            position: absolute !important;
            width: 20px !important;
            height: 20px !important;
            background: #ffffff !important;
            border-radius: 50% !important;
            top: 2px !important;
            left: 2px !important;
            transition: transform 0.2s ease !important;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2) !important;
        }

        .ac-toggleInput input[type="checkbox"]:checked {
            background: #5b5fc7 !important;
        }

            .ac-toggleInput input[type="checkbox"]:checked::after {
                transform: translateX(20px) !important;
            }

        .ac-toggleInput input[type="checkbox"]:focus {
            outline: none !important;
            box-shadow: 0 0 0 2px rgba(91, 95, 199, 0.4) !important;
        }

/* ==========================================================================
   Images
   ========================================================================== */

.ac-image {
    border-radius: 6px !important;
    overflow: hidden !important;
}

    .ac-image img {
        display: block !important;
        max-width: 100% !important;
        height: auto !important;
    }

/* ==========================================================================
   Containers & Column Sets
   ========================================================================== */

.ac-container {
    padding: 0 !important;
}

    .ac-container.style-emphasis {
        background: #f5f5f5 !important;
        border-radius: 6px !important;
        padding: 0.875rem !important;
        border: 1px solid #e5e5e5 !important;
    }

    .ac-container.style-accent {
        background: #f0f0ff !important;
        border-radius: 6px !important;
        padding: 0.875rem !important;
        border: 1px solid #d8d8f0 !important;
    }

    .ac-container.style-attention,
    .ac-container.style-warning {
        background: #fff8e6 !important;
        border-radius: 6px !important;
        padding: 0.875rem !important;
        border: 1px solid #ffd966 !important;
    }

    .ac-container.style-good {
        background: #f0fff0 !important;
        border-radius: 6px !important;
        padding: 0.875rem !important;
        border: 1px solid #107c10 !important;
    }

.ac-columnSet {
    display: flex !important;
    gap: 1rem !important;
}

.ac-column {
    flex: 1 !important;
}

/* ==========================================================================
   Fact Sets
   ========================================================================== */

.ac-factSet {
    display: grid !important;
    grid-template-columns: auto 1fr !important;
    gap: 0.5rem 1rem !important;
    padding: 0.75rem !important;
    background: #f9f9f9 !important;
    border-radius: 6px !important;
    border: 1px solid #e5e5e5 !important;
}

.ac-fact-title {
    font-weight: 600 !important;
    color: #242424 !important;
}

.ac-fact-value {
    color: #424242 !important;
}

/* ==========================================================================
   Separators
   ========================================================================== */

.ac-separator {
    border: none !important;
    height: 1px !important;
    background: #e5e5e5 !important;
    margin: 0.75rem 0 !important;
}

/* ==========================================================================
   Media Elements
   ========================================================================== */

.ac-media-poster {
    border-radius: 6px !important;
    overflow: hidden !important;
}

.ac-media-playButton {
    background: rgba(91, 95, 199, 0.9) !important;
    border-radius: 50% !important;
    width: 56px !important;
    height: 56px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    cursor: pointer !important;
    transition: all 0.2s ease !important;
}

    .ac-media-playButton:hover {
        background: rgba(74, 78, 181, 0.95) !important;
        transform: scale(1.05) !important;
    }

    .ac-media-playButton svg {
        fill: white !important;
    }

/* ==========================================================================
   Rich Text Block
   ========================================================================== */

.ac-richTextBlock {
    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif !important;
    line-height: 1.6 !important;
    color: #242424 !important;
}

    .ac-richTextBlock a {
        color: #5b5fc7 !important;
        text-decoration: none !important;
    }

        .ac-richTextBlock a:hover {
            text-decoration: underline !important;
        }

/* ==========================================================================
   Icon styling (for cards with icons like the connection card)
   ========================================================================== */

.ac-icon {
    width: 32px !important;
    height: 32px !important;
    border-radius: 6px !important;
}

/* Service info styling */
.ac-columnSet[data-ac-type="service-info"],
.service-info {
    background: #f9f9f9 !important;
    padding: 0.875rem !important;
    border-radius: 6px !important;
    border: 1px solid #e5e5e5 !important;
}

/* ==========================================================================
   Warning/Notice Styling
   ========================================================================== */

.ac-container[style*="background-color: rgb(255, 248, 230)"],
.ac-container.warning-container {
    background: #fff8e6 !important;
    border: 1px solid #ffd966 !important;
    border-radius: 6px !important;
    padding: 0.875rem !important;
}

/* ==========================================================================
   Error State
   ========================================================================== */

.ac-error {
    padding: 1rem;
    background: #fef1f1;
    border: 1px solid #f5c2c2;
    border-radius: 6px;
    color: #d13438;
    font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif;
    font-size: 0.875rem;
}

/* ==========================================================================
   Animation - Card entrance
   ========================================================================== */

.ac-adaptiveCard,
.ac-m365-theme {
    animation: ac-fadeIn 0.2s ease-out;
}

@keyframes ac-fadeIn {
    0% {
        opacity: 0;
        transform: translateY(8px);
    }

    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ==========================================================================
   Responsive Adjustments
   ========================================================================== */

@media (max-width: 640px) {
    .ac-adaptiveCard,
    .ac-m365-theme {
        padding: 1rem !important;
        border-radius: 6px !important;
    }

    .ac-columnSet {
        flex-direction: column !important;
        gap: 0.75rem !important;
    }

    .ac-actionSet {
        flex-direction: column !important;
    }

    .ac-pushButton {
        width: 100% !important;
    }
}

/* ==========================================================================
   Print Styles
   ========================================================================== */

@media print {
    .ac-adaptiveCard,
    .ac-m365-theme {
        box-shadow: none !important;
        border: 1px solid #ccc !important;
    }

    .ac-pushButton {
        display: none !important;
    }
}
